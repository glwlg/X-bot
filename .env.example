# Please copy this file to .env and fill in your bot token.
# DO NOT commit the .env file to version control.

# Telegram Bot Configuration (Optional)
TELEGRAM_BOT_TOKEN="YOUR_TELEGRAM_BOT_TOKEN_HERE"

# Discord Bot Configuration (Optional)
DISCORD_BOT_TOKEN="YOUR_DISCORD_BOT_TOKEN_HERE"

# DingTalk Bot Configuration (Optional)
DINGTALK_CLIENT_ID=""
DINGTALK_CLIENT_SECRET=""

# OpenAI API Configuration
LLM_BASE_URL=""
LLM_API_KEY="your-openai-api-key-here"
CORE_MODEL="gpt-4o-mini"
ROUTING_MODEL="gpt-4o-mini"
CREATOR_MODEL="gpt-4o"
OPENAI_IMAGE_MODEL="gpt-image-1"
AI_TOOL_MAX_TURNS="20"
AI_TOOL_EXEC_TIMEOUT_SEC="420"
AI_TOOL_REPEAT_GUARD="3"
EXTENSION_EXEC_TIMEOUT_SEC="600"

# User Access Control
# ADMIN_USER_IDS: Super admins who can manage the whitelist using /adduser and /deluser
# Example: ADMIN_USER_IDS="123456789,987654321"
ADMIN_USER_IDS=""

# ============================================
# Deployment Configuration (IMPORTANT!)
# ============================================
# X_DEPLOYMENT_STAGING_PATH 必须设置为宿主机的绝对路径！
# 因为 x-bot 运行在容器内，但调度的是宿主机 Docker。
# 当 docker compose up 执行时，卷挂载使用的是宿主机路径体系。
# 所以容器内路径必须与宿主机路径完全一致。
#
# 示例 (Linux):
#   X_DEPLOYMENT_STAGING_PATH="/home/youruser/docker/deployment_staging"
#
# 示例 (WSL):
#   X_DEPLOYMENT_STAGING_PATH="/mnt/d/docker/deployment_staging"
#
# ❌ 错误示例 (不要用这些):
#   X_DEPLOYMENT_STAGING_PATH="/app/data/deployment_staging"  # 宿主机不存在 /app
#   X_DEPLOYMENT_STAGING_PATH="./data"                        # 相对路径不可靠
#
X_DEPLOYMENT_STAGING_PATH=""

# Server IP (for displaying access URLs after deployment)
SERVER_IP=""

# ============================================
# Heartbeat (Checklist + Proactive)
# ============================================
# Per-user heartbeat state files:
#   ${DATA_DIR}/runtime_tasks/{user_id}/HEARTBEAT.md
#   ${DATA_DIR}/runtime_tasks/{user_id}/STATUS.json
HEARTBEAT_ENABLED="true"
HEARTBEAT_EVERY="30m"
HEARTBEAT_TARGET="last"
HEARTBEAT_ACTIVE_START="08:00"
HEARTBEAT_ACTIVE_END="22:00"
HEARTBEAT_TIMEZONE=""
HEARTBEAT_TICK_SEC="30"
HEARTBEAT_SUPPRESS_OK="true"
HEARTBEAT_LOCK_TIMEOUT_SEC="20"
HEARTBEAT_MODE="readonly"
HEARTBEAT_READONLY_DISPATCH="true"
# Orchestrator recovery budget for recoverable terminal failures.
AUTO_RECOVERY_MAX_ATTEMPTS="3"

# ============================================
# Dual-Layer Worker Runtime
# ============================================
# Worker metadata/tasks:
#   ${DATA_DIR}/WORKERS.json
#   ${DATA_DIR}/WORKER_TASKS.jsonl
# Worker workspaces:
#   ${USERLAND_ROOT}/{worker_id}
# Per-worker file queue:
#   ${USERLAND_ROOT}/{worker_id}/TASK.md
#   ${USERLAND_ROOT}/{worker_id}/TASK_HISTORY.md
USERLAND_ROOT=""
# Legacy task_inbox persistence switch (default off; TASK.md is the source of truth)
TASK_INBOX_PERSIST="false"
WORKER_DEFAULT_BACKEND="core-agent"
WORKER_EXEC_TIMEOUT_SEC="900"
WORKER_RUNTIME_MODE="local"
WORKER_DOCKER_CONTAINER="x-bot-worker"
WORKER_DOCKER_DATA_DIR="/app/data"
WORKER_CODEX_COMMAND="codex"
WORKER_GEMINI_CLI_COMMAND="gemini-cli"
WORKER_SHELL_COMMAND="sh"
WORKER_CODEX_ARGS_TEMPLATE="exec {instruction}"
WORKER_GEMINI_ARGS_TEMPLATE="--prompt {instruction}"
WORKER_AUTH_STATUS_TIMEOUT_SEC="45"
WORKER_CODEX_AUTH_START_ARGS="auth login"
WORKER_GEMINI_AUTH_START_ARGS="auth login"
WORKER_CODEX_AUTH_STATUS_ARGS="auth status"
WORKER_GEMINI_AUTH_STATUS_ARGS="auth status"
WORKER_FALLBACK_CORE_AGENT="true"

# Worker dispatch mode:
#   sync  -> manager waits for worker result
#   async -> manager returns ACK immediately, worker daemon executes in background
WORKER_DISPATCH_MODE="async"

# Worker daemon tuning (used by x-bot-worker container)
WORKER_DAEMON_ID="x-bot-worker"
WORKER_DAEMON_POLL_SEC="1.5"
WORKER_DAEMON_MAX_CONCURRENCY="2"

# Manager-side worker result relay (pushes completed async jobs back to user chat)
WORKER_RESULT_RELAY_ENABLED="true"
WORKER_RESULT_RELAY_TICK_SEC="2"

# Core chat scheduling policy:
#   worker_only | worker_preferred | orchestrator
CORE_CHAT_EXECUTION_MODE="worker_only"
# Preferred backend when core chat is delegated to worker.
#   core-agent | codex | gemini-cli | shell
CORE_CHAT_WORKER_BACKEND="core-agent"

# Comma-separated paths considered kernel-layer read-only by core primitives.
# Supports absolute paths or project-relative paths.
KERNEL_PROTECTED_PATHS="src/core,src/services,src/handlers"
