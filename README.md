# X-Bot

**X-Bot** 是一个全能型 AI Telegram 机器人，集成了多平台媒体下载、智能对话、文档分析、语音交互和 AI 绘图功能。

它不仅仅是一个下载工具，更是你的智能生活助手。

## 🏗️ 系统架构

> **开发者说明**：详细的系统架构图、模块说明及开发指南，请参阅独立的开发文档：
> 
> � **[X-Bot 开发手册 (DEVELOPMENT.md)](DEVELOPMENT.md)**

## ✨ 核心功能

### 🤖 强大的 AI 能力
-   **多轮智能对话**：基于 Gemini 3.0 Flash 模型，支持深层上下文理解。
-   **🧠 长期记忆 (New)**：
    -   **个性化记忆**：自动记住你的偏好、习惯和重要信息（如“我住在北京”，“不要吃辣”）。
    -   **隐私隔离**：采用**物理级文件隔离**架构，每个用户的记忆存储在独立的加密空间，绝无数据混淆风险。
-   **多模态分析**：
    -   **图片分析**：发送图片，AI 识别内容并回答问题。
    -   **视频分析**：发送视频，AI 理解画面并进行总结或问答。
    -   **文档分析**：支持 PDF 和 DOCX 文档，提取内容并回答相关问题。
-   **网页摘要**：发送链接，自动抓取网页内容并生成精简摘要。
-   **语音交互**：发送语音消息，AI 自动转录为文字并进行回复。
-   **AI 绘图**：使用 Google nano banana 模型，根据描述生成高质量图像。

### 📹 全能媒体下载
-   **支持平台**：YouTube, X (Twitter), Instagram, TikTok, Bilibili 等。
-   **多种格式**：支持下载高清视频或仅提取音频 (MP3)。
-   **秒传技术**：智能文件缓存与去重，已下载内容无需重复下载，直接秒发。

### 📊 数据持久化与统计
-   **SQLite 数据库**：所有数据（对话历史、文件映射、用户统计）持久化存储。
-   **Docker 卷映射**：重启容器不丢失任何数据。
-   **使用统计**：通过 `/stats` 命令随时查看个人使用数据。

## ✨ 进阶功能

### 🌍 沉浸式翻译
-   **双向翻译**：开启后，自动将外语翻译为中文，中文翻译为英文。
-   **无缝体验**：使用 `/translate` 开启/关闭，专为跨语言交流设计。

### 📢 订阅监控
-   **RSS/关键词监控**：使用 `/monitor <关键词>` 或 `/subscribe <URL>` 订阅感兴趣的内容。
-   **自动推送**：Bot 每 30 分钟检查一次，发现新内容自动推送到聊天窗口。

### 🔗 智能链接与上下文
-   **智能引用**：引用一条包含链接/新闻的消息并发送 "总结一下"，Bot 会自动抓取原链接内容作为上下文进行回答。
-   **深度解析**：内置 Google News 解码器与反爬虫兜底策略，确保能获取到最真实的网页内容。

### 💬 自然语言意图识别 (New)
-   **告别指令**：无需死记硬背 `/download` 或 `/remind`，直接说出你的需求。
-   **智能路由**：
    -   发送 "下载这个视频 https://..." -> 自动识别并下载
    -   发送 "10分钟后提醒我喝水" -> 自动设置提醒
    -   发送 "画一只猫" -> 自动调用 AI 绘图
    -   发送 "订阅这个RSS https://..." -> 自动添加订阅

### 🎬 视频深度分析
-   **智能摘要**：对于超大视频文件 (>50MB)，自动提取音频并生成内容摘要。
-   **音频提取**：支持从大视频中仅提取音频发送。

## 🚀 快速部署

### 1. 准备环境
确保已安装 [Docker](https://docs.docker.com/get-docker/) 和 [Docker Compose](https://docs.docker.com/compose/install/)。

### 2. 获取配置
创建一个 `.env` 文件（参考 `.env.example`）：

```ini
# Telegram
TELEGRAM_BOT_TOKEN="你的 Bot Token"

# Gemini AI (https://aistudio.google.com/)
GEMINI_API_KEY="你的 API Key"
GEMINI_MODEL="gemini-2.0-flash"
IMAGE_MODEL="imagen-3.0-generate-002"

# 访问控制 (可选)
# ADMIN_USER_IDS: 管理员 ID 列表，拥有 /adduser 和 /deluser 权限
ADMIN_USER_IDS="123456789"
```

### 4. 权限管理 (新)
 Bot 启动后，管理员可以使用以下命令动态管理允许使用的用户白名单：
 - `/adduser <user_id> [备注]` : 添加用户到白名单
 - `/deluser <user_id>` : 从白名单移除用户
 - 所有白名单用户的权限数据将持久化保存在数据库中。

### 3. 一键启动
```bash
docker-compose up --build -d
```

### 4. 数据管理
所有持久化数据存储在 `./data` 目录（SQLite 数据库）和 `./downloads` 目录（媒体文件）。

## 🤖 使用指南

### 常用命令
### 常用命令
-   `/start` - 呼出主菜单
-   `/download` - 快速进入下载模式
-   `/image` - 快速进入画图模式
-   `/translate` - 开启/关闭沉浸式翻译
-   `/remind <时间> <内容>` - 设置定时提醒
-   `/monitor <关键词>` - 监控特定话题新闻
-   `/stats` - 查看我的使用统计
-   `/help` - 查看帮助信息

### 交互方式
-   **直接聊天**：发送文字、语音、图片、视频或文件，AI 自动响应。
-   **下载视频**：点击菜单中的「下载视频」，选择格式后发送链接。

---

---
Enjoy X-Bot! 🚀
